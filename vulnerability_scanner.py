import socket

target = input("inserisci indirizzo IP da scansire:")
portrange = input("inserisci il port range da scansire (di default scansiona tutte le porte):")



if (portrange == ""):
	lowport = 0
	highport = 65535
else:
	lowport = int(portrange.split('-')[0])
	highport = int(portrange.split('-')[1])

	

print("scan host", target, "dalla porta", lowport, "alla porta", highport)

porte_aperte = []

for port in range(lowport, highport + 1):
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.settimeout(0.00000001)
	status = s.connect_ex((target, port))
	if status == 0:
		print(" ***  PORTA" , port, " APERTA ***")
		porte_aperte.append(port)
	else:
		print('- PORTA', port,  " CHIUSA")
	s.close()
	
if porte_aperte:
	print("\nRiepilogo porte aperte: ", porte_aperte)
else:
	print("\nnessuna porta aperta trovata")